LIBDESTDIR = /usr/lib
EXEDESTDIR = /usr/lib/chaos
SUBS = hostlib.o readhosts.o chopen.o
CFLAGS = -g -DBSD42
INCLUDE = /usr/include/

all: libhosts.a hosts2 chaosnames

libhosts.a: $(SUBS)
	ar uv libhosts.a $(SUBS)
	ranlib libhosts.a

$(SUBS): hosttab.h

hosts2: hosts2.c hosttab.h
	$(CC) $(CFLAGS) -o hosts2 hosts2.c

chaosnames: chaosnames.o libhosts.a
	cc -o chaosnames chaosnames.o libhosts.a

$(LIBDESTDIR)/libhosts.a: libhosts.a
	cp libhosts.a $(LIBDESTDIR)/libhosts.a
	ranlib $(LIBDESTDIR)/libhosts.a
	chmod 644 $(LIBDESTDIR)/libhosts.a


install: all $(LIBDESTDIR)/libhosts.a
	install -c -m 644 hosttab.h $(INCLUDE)
	install	-c -m 705 chaosnames $(EXEDESTDIR)
	install	-c -m 705 hosts2 $(EXEDESTDIR)

clean:
	rm -f *.o  hosts2 hosttab.c hosts libhosts.a hosttab
